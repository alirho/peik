# پرامپت‌های هوش

## پرامپت‌های طراحی

### پرامپت ۱
می‌خوام برام یک ابزار چت با مدل‌های هوش پیاده‌سازی کنی.

### پرامپت ۲
می‌خوام طرح را برای زبان فارسی بهینه‌سازی کنی.

## پرامپت‌های پیاده‌سازی

### پرامپت ۱
می‌خوام یک ابزار گپ (chat) با مدل‌های هوش مصنوعی با نام گوگ (goug) بسازی که ویژگی‌های زیر را داشته باشه:
1. فقط با جاوااسکریپت خام (بدون فریمورک)
2. بتونه به OpenAI متصل بشه
3. پیام‌ها را ذخیره کنه (localStorage)
4. یک رابط کاربری ساده داشته باشه
5. کاربر API key خودش را وارد کنه (یک input ساده)
6. پیام‌ها بعد از رفرش صفحه باقی بمونن
7. طراحی ساده و تمیز (فارسی و راست‌چین)
8. کدها خوانا و کامنت‌دار باشن
9. فقط یک مکالمه (نه لیست مکالمه‌ها)

### پرامپت ۲
خب می‌خوام پروژه را بدون استفاده از هیچ چارچوبی (framework) پیاده‌سازی کنی.
- از react استفاده نکن.
- فقط از pure javascript استفاده کن.
- نمی‌خوام در پروژه هیچ فایلی با پسوندهای tsx و ts وجود داشته باشه.

### پرامپت ۳
در کنسول مرورگر خطای زیر نمایش داده می‌شه:

```js
Uncaught TypeError: The specifier “@google/genai” was a bare specifier, but was not remapped to anything. Relative module specifiers must start with “./”, “../” or “/”.
```

### پرامپت ۴
حالا می‌خوام همین کد را به یک **معماری ماژولار و حرفه‌ای** تبدیل کنی.
1. هر فایل مسئول یک وظیفه باشه.
2. از کتابخانه tailwind استفاده نکن و بجاش از CSS استفاده کن.
3. جداسازی کامل: Core نباید UI را بشناسه. UI از Core از طریق API استفاده کنه.
4. بدون کتابخانه خارجی: حذف `@google/genai`
5. استفاده از ES6 Modules
    - export/import استاندارد   
    - هر فایل یک ماژول
6. ویژگی‌های فعلی مثل Streaming response و Auto-resize textarea و Loading state را حفظ کن
7. معماری Event-Driven
    - ChatEngine رویداد emit کنه
    - ChatUI به رویدادها گوش بده

> پس از تغییر معماری پروژه، پاسخ مدل gemini نمایش داده نمی‌شد. با کمک مدل sonnet و لاگ‌گذاری در کد و پیدا کردن خطا مشکل بر طرف شد.

### پرامپت ۵
زمانی که صفحه را بازنشانی (refresh) می‌کنم، فقط پیام‌های مدل هوش را نمایش می‌ده و پیام‌های ارسالی من را نمایش نمی‌ده.

### پرامپت ۶
می‌خوام بهبودهای زیر را در پروژه اعمال کنی:
1. مدیریت بهتر Stream (Buffer): اگر یک پاسخ وسط JSON قطع بشه، خطا می‌ده، یک متغیر `buffer` بساز که خطوط ناتمام را نگه داره، هر خط کامل را پردازش کن، خط آخر ناقص را برای chunk بعدی نگه دار
2. پیام‌های خطای واضح: الان همه خطاها یک شکل نمایش داده می‌شن
    - `401`: "کلید API اشتباه است"
    - `429`: "درخواست‌های زیاد. لطفاً 1 دقیقه صبر کنید"
    - `400`: "درخواست نامعتبر"
    - `500`: "مشکل در سرور، دوباره تلاش کنید"
    - خطای شبکه: "اینترنت قطع است"
3. تلاش مجدد خودکار (Retry): اگر درخواست fail شد، 3 بار دوباره تلاش کنه
    - هر بار تأخیر بیشتری داشته باشه (1 ثانیه، 2 ثانیه، 4 ثانیه)
    - فقط برای خطاهای موقت retry کنه (مثل 500، network error)
    - برای خطاهای دائمی retry نکنه (مثل 401، 400)
4. محدودیت زمانی (Timeout): اگر درخواست بیشتر از 30 ثانیه طول کشید، لغوش کنه
    - پیام بده: "درخواست خیلی طول کشید، دوباره تلاش کنید"
5. نمایش بهتر خطا در UI: به جای `alert()` یک پیام رنگی در خود چت نشان بده
    - پیام خطا قرمز رنگ باشه و بعد از 5 ثانیه محو بشه
نکات مهم:
- کدهای فعلی رو خراب نکن، فقط بهبودشون بده
- کامنت‌های فارسی برای بخش‌های جدید بنویس
- ساده و خوانا بنویس

### پرامپت ۷
الان فقط Gemini پشتیبانی می‌شه. می‌خوام کاربر بتونه بین مدل‌های مختلف انتخاب کنه.
1. انتخاب نوع مدل
    - **Gemini** (فعلی)
    - **OpenAI** (GPT-4, GPT-3.5, و...)
    - **سفارشی** (API خودش)
    - باید مثل OpenAI باشه (استاندارد OpenAI-compatible).
2. تنظیمات مدل
    - **کلید API** (برای همه)
    - **نام مدل** (مثلاً gpt-4، gpt-3.5-turbo)
    - **آدرس API** (فقط برای سفارشی)
      - مثال: `http://localhost:11434/v1/chat/completions` (Ollama)
      - مثال: `https://api.openai.com/v1/chat/completions`
3. تنظیمات باید ذخیره بشن
    - نوع مدل (gemini/openai/custom)
    - کلید API
    - نام مدل
    - آدرس API (اگر سفارشی باشه)

نکات مهم:
1. **کد فعلی را خراب نکن**: Gemini همچنان کار کنه
2. **UI ساده**: فرم تنظیمات قشنگ و ساده باشه
3. **Validation**: اگر آدرس API غلط باشه، خطا بده
4. **کامنت‌ها**: برای بخش‌های جدید کامنت فارسی بنویس
5. **Error handling**: خطاهای OpenAI را هم مدیریت کن
6. دقت کن معماری پروژه که ماژولار و هر فایل یک وظیفه را رعایت کن.

### پرامپت ۸
یک README.md حرفه‌ای برای پروژه گوگ بنویس. در این سند بگو که پروژه با استفاده از هوش مصنوعی نوشته شده.

> پس از دریافت طرح‌ها و کد‌های پایه از stitch، کدهای را به مدل‌های sonnet4.5 و gemini 2.5 pro تا کتابخانه tailwind را از کدهای پایه حذف کنند.
> با توجه به اینکه کدهای اصلاح شده sonnet 4.5 بسیار نزدیک‌تر به طرح بود آن‌ها را برای پیاده‌سازی به مدل هوش دادم.

### پرامپت ۹
من کدهای طرح جدید UI برای پروژه گوگ را بارگذاری کردم. می‌خوام:
1. این طرح را جایگزین طرح فعلی کن
2. کلاس‌ها و IDها را با کد JavaScript فعلی تطبیق بده
3. مودال تنظیمات را در این طرح جدید بساز (فایل key.html)
نکات مهم:
- کد JavaScript فعلی را خراب نکن
- فقط UI را تغییر بده
- تمام قابلیت‌های فعلی را حفظ کن
- صفحه گپ (chat) و مودال کلیدها را طبق طرح جدید بساز

### پرامپت ۱۰
ازت می‌خوام تغییرات زیر را اعمال کنی:
1. در صفحه گپ خطی که بالای بخش نوشتن کاربر هست را حذف کن.
2. رنگ پنل کناری (sidebar) با چیزی که در طرح‌ها فرستادم یکسان نیست. رنگش با بقیه صفحه یکسانه که درست نیست.
3. دقت کن اسم پروژه را باید فارسی بنویسی «گوگ»
4. ازت می‌خوام مدال مدیریت کلیدها را دقیقا مشابه طرح پیاده‌سازی کنی.

### پرامپت ۱۱
خب با تغییراتی که دادی دکمه مدیریت کلیدها در پنل سمت راستی شبیه دکمه نیست، البته وقتی ماوس روش قرار می‌گیره به صورت دکمه نمایش داده می‌شه.

### پرامپت ۱۲
حالا ازت می‌خوام بخش مدیریت کلیدها را دقیقا مشابه کدی که بارگذاری کردم پیاده‌سازی کنی بدون هیچ تغییری.

### پرامپت ۱۳
بخشی که کاربر متن خودش را وارد می‌کنه با بخش نمایش پیام‌ها در یک راستا نیست. در سمت راست مشکلی نیست ولی در سمت چپ متن‌ها نمایش داده شده و فیلد ورود متن با هم در یک راستا نیستن.

عکس مشکل را پیوست کردم.

### پرامپت ۱۴
تغییری که دادی مشکل را حل نکرد.

### پرامپت ۱۵
تغییری که ایجاد کردی باعث شد ناترازی به سمت راست منتقل بشه.

### پرامپت ۱۶
بخش گپ به درستی پیاده‌سازی نشده، پیام‌های نمایش داده شده با فیلد وردی در یک راستا نیستن.
1. پیام‌هایی که کاربر می‌نویسه از سمت چپ صفحه فاصله دارن
2. پیام‌های مدل هوش هم از سمت راست صفحه فاصله دارن.

در صورتیکه باید به این شکل باشه:
1. پیام کاربر باید سمت راست نمایش داده بشه و انتهای پیام باید از سمت چپ صفحه فاصله داشته باشه.
2. پیام مدل هوش هم باید سمت چپ نمایش داده و انتهای پیام از سمت راست صفحه فاصله داشته باشه.

### پرامپت ۱۷
تغییرات را کامل انجام ندادی.
1. آواتار کاربر به سمت راست منتقل نشده و جای قبلیش باقی مونده
2. آواتار هوش هم باید به سمت چپ پیام هوش منتقل بشه

### پرامپت ۱۸
ساختار فایل‌های HTML و CSS پروژه پیچیده شده، می‌خوام این فایل‌ها را به یک معماری ماژولار و مبتنی بر کامپوننت تبدیل کنی تا نگهداری و توسعه اون‌ها آسان‌تر بشه.

1.  **ساده‌سازی `index.html`:** این فایل باید بسیار سبک بشه و فقط شامل یک المنت ریشه در `<body>` باشه.
2.  **ایجاد کامپوننت‌های HTML:** یک پوشه جدید به نام `templates/` بساز.
    - هر بخش از HTML باید یک قالب جدا باشه.
3.  بارگذاری پویای کامپوننت‌ها
4.  فایل `chatUI.js` را هم باید ماژولار کنی.
5.  برای **استایل‌ها** این موارد را رعایت کن
    - حداکثر 100 خط در هر فایل CSS
    - نام‌گذاری BEM یا مشابه
    - هیچ استایل inline نباشه
6. برای فایل‌های **JavaScript**:
   - حداکثر 200 خط در هر فایل
   - Export/Import صحیح
   - JSDoc برای توابع
7. برای فایل‌های **HTML**:
   - Templates در فایل جداگانه یا template literals
   - Semantic HTML
   - Accessibility
8.  **جداسازی Core/UI**: دقت کن که ظاهر باید از منطق برنامه جدا باشه و وابستگی نداشته باشن
     - Core هیچ DOM manipulation نکند
     - UI فقط از Core API استفاده کند
     - Event-driven communication
9.  ساختار پیشنهادی:

```
goug/
├── index.html
│
├── styles/
│   ├── variables.css        # CSS Variables
│   ├── base.css             # Reset, Typography
│   ├── layout.css           # Layout اصلی (sidebar, main)
│   ├── components/
│   │   ├── modal.css        # Modal styles
│   │   ├── sidebar.css      # Sidebar styles
│   │   ├── messages.css     # Message bubbles
│   │   ├── input.css        # Input area
│   │   └── buttons.css      # Button styles
│   └── utilities.css        # Utilities (spinner, typing, error)
│
├── js/
│   ├── ui/
│   │   ├── chatUI.js
│   │   └── components/
│   │       ├── settingsModal.js     # مدیریت modal
│   │       ├── messageRenderer.js   # رندر پیام‌ها
│   │       └── sidebarManager.js    # مدیریت sidebar
│   └── main.js
│
└── templates/              # HTML Templates
    ├── settingsModal.html
    └── sideBar.html
```
این موارد را هم حتما رعایت کن:
- **Single Responsibility**: هر فایل یک مسئولیت
- **Reusability**: کامپوننت‌های قابل استفاده مجدد
- **Maintainability**: کد قابل نگهداری

### پرامپت ۱۹
اینکه همه فایل‌های css را در html آوردی به نظرم خوب نیست، بهتره فقط یک فایل را در این بخش معرفی کنی.